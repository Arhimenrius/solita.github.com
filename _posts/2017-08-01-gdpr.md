---
layout: post
title: General Data Protection Regulation (GDPR) - Protect your data
author: arto
excerpt: How to create working software that fulfills new privacy requirements
tags:
- GDPR
- Security
- Privacy
---

Can you spare 20 000 000 euros? That's the minimum it is going to cost you, if you neglect data privacy issues in your software. This sanction is defined in European Union's new General Data Protection Regulation. For larger enterprises, up to 4% of their global turnover can amount up to hundreds of millions. Ignorance is not a good defence here: In case of data breach, or violation of registrars rights, your systems and databases and processes might go under audit. And if only answer you are capable of giving to questions at this point is: WHAT - you will be in trouble.

Fortunately, there exists a pretty good technique that lets you avoid any fees and negative issues, and start enjoying the positive effects of improved and clarified data privacy. It is called: be smart. In other words, educate yourself on what it means, please do not panic, and handle customer data with care and transparency, and protect it at least as good as any payment information or health care data. Let me elaborate a little bit.

## What is the General Data Protection Regulation?

GPDR is defined in a pretty boring document called Regulation (EU) 2016/679. Document itself can be downloaded (see the links at end of this), is translated in all major EU languages, and weighs pretty heavy at 88 pages of legal text. It does replace earlier Data Protection Directive, that's been in effect since 1995. New GDPR regulation is already valid and in effect, but not enforced, so in other words you are already expected to comply with it, including both new and old information systems you have, but the sanctions and fines will start running in full effect summertime 2018.

There are some myths about GDPR, and obviously many interpretations on how to comply are still being defined. We will be a lot wiser next year, and even more so in ten years time when we see how the fines are actually being applied and used, and what is exactly considered personal data, and what is considered enough protection for it.

There are already some cases where companies have been simply erasing their customer databases - because easy way to avoid any GDPR requirements or fines is to not have any person data in your systems. However, for most companies or organizations this is simply not an option.

So, whether you are a big company, or little one, it doesn't let you avoid the responsibilities or heavy penalties. Ignorance is not an excuse either. It's also not an excuse to try to move responsibilities to third parties - contracts are a good thing, but responsibility is shared. And it's also a bad idea to concentrate on one aspect of GDPR and neglect the others - you need the holistic view here. Also, this is not just about customer data, but also HR data. This is also not just about commercial systems, but also includes non-profit organizations, government organizations, etc. To put it shortly: If it's not just you maintaining records of only your own personal life, you should comply with GDPR requirements.

So, to understand how to comply, we probably need to make an interpretation of what it means, and what it actually requires.

## What does it really mean?

Many of the concepts defined here already exist and have been practiced. But there are some new things, too. The sanctions and fines are one area. There is now pretty heavy stick to encourage spending some money on security and privacy. This is a very good thing, because traditionally security has not been very sexy issue, until something bad happens. Then it becomes very important. There is now also a concept, privacy by default/privacy by design, which basically means steps built in when acquiring or building new software. Most importantly, however, you are expected to be able to demonstrate exactly how you are protecting personal data, in case of audit.

Another new area here is expanded rights of a registrar. That is, any person whose personal information exists in any of your registers or information systems. There has already been requirements for people to be able to check their data, but new rights include:

1. The right to be informed
2. The right of access
3. The right to rectification
4. The right to erasure
5. The right to restrict processing
6. The right to data portability
7. The right to object
8. Rights in relation to automated decision making and profiling.

So, implementing these typically requires some support from the systems. And do remember, this is not only about new systems, but also about very very old ones. If you are right now thinking that you don't need any support, you can instead use SQL directly and manual processes where Bob will gather the data and send it via email... Remember that it makes it very difficult to demonstrate exactly who has access to the data and which data has been accessed. And this in turn causes issues with next expanded topic: Data Breaches.

Handling of Data Breaches has been also expanded. There is now a requirement to notify the authorities within 72 hours from the moment when data breach is detected. Remember that breach does not always mean evil hackers penetrating your systems, but can also occur from inside. When you are reporting the breach, data protection authorities will ask you some questions. Important ones would be: When did this happen, which of your customers/registrars did it effect, what kind of data was included, how much risk there is with this data breach, etc. And your answer at this point will effect two things: How much fines might you end up paying for neglect, if any, and how large amount of your customer base do you need to notify about the breach, if any.

There is a lot more, but I try to limit this discussion to mostly building new software, not resolving all IT issues of an organization. Hopefully by scoping tight we can get to some actual advice on how to tackle the new challenges - and furthermore how to benefit from them. So here goes...

## Building GDPR compliant software

When you want to build good security and privacy in software, it has to begin with the design. First step of privacy design is to design and document what do you need to collect, how will you process it, what is the life-cycle of this data, how it will move over networks, and how will it be protected.

The privacy regulation mentions minimization several times as something you should do. Minimal collection of data, minimal life-cycle of data, minimal exposure of data. There are good practises to begin with. Just collect what you need, not anything extra 'just in case'. When you store it in databases, instead of letting it sit there eternally, define life-cycles and automated cleanups that guarantee data is removed automatially when it is no more needed (or archived, then deleted). What you do not have in your systems does not need to be protected anymore, cannot be stolen, and cannot be exported.

Furthermore, minimal access is a good principle. Instead of every user having access to every bit of data, no matter if they need it or not, for personally identifiable data we wish to have access control, and audit trails. So if you are asked about any bit of important data, you are able to tell exactly when it was accessed, and by who, and hopefully also why. This is also important for just reading the data.

After you are done with these decisions, you should document them well, since this is part of the responsibility to demonstrate your compatibility and protection measures. You should also use this information to educate your users, customers, registrars about how their data is processed within your systems. This part is about the transparency requirement.

## Means of protecting the data

Easiest way to protect the data is to erase it completely. By this I mean, enforce the data life-cycles, and proper archival, and erasure mechanisms. But life-cycle may easily be years, or even decades, during which you need to protect the data.

Furthermore, data does not only live in production systems. Often there are copies of it also in test environments, demo environments, training environments, analysis environments, data warehouses/lakes, on disk, and even as email attachments. These need to be protected with similar means as actual production environment, as long as it is actual PII data. And herein lies the first possibility.

Anonymization means taking a bit of data, and removing any personally identifiable information from it, for example by masking, overwriting, etc. Your production data may not typically be anonymized, but when this data is used for other purposes, by anonymizing it efficiently, it becomes free of GDPR limitations and requirements. Do note that effective anonymization may be sometimes very difficult and not so clear area. Still, anonymized data is already less dangerous than raw person data.

Similarly, pseudonymization means that instead of actual identity, data would contain a pseudonym, for example number #76575, that would refer to person identity elsewhere. Idea is that by looking just at the data, you would not be able to define identity, but you would still have capability to find it by combining data in multiple sources. As protection mechanism, this is by far not so efficient as anonymization. But in case of a data breach, it might be the difference between having or not having to contact million users about a data breach that may potentially leaked damaging information.

It is not always easy to answer the question whether data is properly anonymized or not. GDPR regulation mentions examples of combining location information, such as times and places of purchase, as an eample of identifiable information. Also, data set size is an issue here, if there's very small set of data, and we know who are in it already, it might be possible to deduct identity from not so obvious data (for example post number and first name), or if identity can be deducted by combining information from multiple places. So if you choose to use pseudonymization/anonymization, you have to be careful that they are efficient enough for your data, and do remember that this might change by time, if you collect more and more datapoints of registrar.

For test environments we can of course choose another path. Instead of using masked or anonymized production data for testing, we can use full synthesis, which means we generate realistic looking data, which is still not actual user data. Meaning, it's not governed by GDPR rules and person rights anymore. This would be ideal approach when building and testing systems, but it has traditionally been hard because it requires you to know and understand the data, and it is often not representative enough of the real data. I think this is changing. GDPR regulations make it very difficult to purify production data so it would be freely usable. Meanwhile test data management tools are getting better and better at reading the database, and understanding data types and purposes, and being able to synthesize based on that. One benefit of synthesis is, that it makes it extremely easy to generate multiples of what we would have in production for stress testing, generate also data for failure test cases, etc. Since I am a huge fan of automated testing this area interests me.

So, in case we cannot resolve issues with anonymization, pseudonymization, or synthesis, what can we do? Encryption is a powerful protection method, which has traditionally been used to protect important data such as social security numbers, payment information, etc. Idea is that if someone manages to steal or access the data without permission, important data would be in encrypted format, unusable without proper key.

GDPR challenges us to new way of thinking, since idea of what data should be protected is now expanding. It's not just the social security number or password that should be protected. It's any bit of personally identifiable information, and potentially also any bit of information directly connected to it. 

It might be tempting to think about encrypting things in database level. For example in Amazon, you could have encrypted database by just ticking the right box when creating a virtual machine. However, full encryption at database level only protects data at rest. The second data goes out from database, it becomes unencrypted again. This makes it still very vulnerable for attack vectors like sql injections, impersonation, etc. In other words, encrypting the database is better than nothing, but just a tiny part of the solution. If you want to use encryption for larger coverage, you can consider encrypting data earlier, and decrypting it later. Also, key management is a crucial challenge, as are user permissions and audit trails.



## How to support registrar rights

Registrar rights have expanded from what they were, too. Very important starting point is idea of transparency. It should be transparent to users of our system, or other registrars, what is collected, why, and how is it processed and stored. Users should be able to verify their data, fix errors in it, see what it is used for, grant and revoke permissions for it, and of course request to erase or export it easily.

Most user requests first require identification. This might actually be hard thing to do if your systems do not have authenticated access, digital identity, or if you have collected information without clear unique identifier. For example, if you have a database where strongest identifier is email donald.duck@duckland.com, how can you guarantee that person who makes request to export the data is the same person who gave it in the first place? What if that email is helpdesk@mycompany.com? So, you need to think how user request will be authenticated in your environment and processes. It might fall down to manual verification, asking enough separate details to identify a person and attach this identity to data in databases.

Once identity is verified, you should check legitimacy of a request. For example, when someone makes request to erase data, you should check whether this can be actually be done, without damaging the customership or process, and without breaking any laws. Similarly, when there's a request to export data, you should have understanding of where are the limits, what all data should and can be exported. Interesting cases arise when person's data includes references to other person's data. This is still not a reason to simply deny the request, but might cause some extra care with handling the request.

Audit trails have been mentioned a few times, but they still are extremely important. If something happens and you need to understand exactly what happened, and what is the scope of potential data breach, you should be able to answer questions like who accessed data, when, why, based on what permission, etc. These data forensics are extremely important means of tracking the damage later, and also help to scope and limit exposure, and thereby have direct effect on potential fines and negative publicity that would follow. The more questions you can answer with data forensics and audit trails, the better. Logging in general is a good idea to revisit, so you know you have set the level right for your purposes (things like network flow logs, access logs, debug logs, can also be useful). Additionally, if you have automated analysis and dashboards on top of logs, you might even trigger alerts, when there's an interesting pattern detected.

However, as final remainder, do note that currently it seems even some of the logs are PII information - since IP address is considered to be identifiable. This means, you need to also protect the logs. Additionally, logs are useless if someone manages to use admin account privileges and changes or erases the logs. So if you want good protection and non-repudiation for them, you might need some extra measures here. Like collecting them to a protected S3 bucket in AWS that is also encrypted, with life-cycle management defined, and has separate write and read access for separate roles. Or log to multiple locations at once.  

## Some final thoughts

Yes, it will be painful for organizations who have a lot of debt in their systems. There can be no privacy if there is not a good security in the first place, and many do not have that. There can be no GDPR compliance if there is no documentation on the registers and systems - and many do not have that either. But nonethless, I am pretty excited about the regulation.

Have you heard the saying, 'No Pain No Gain', or: 'There is no growth in the comfort zone'? Well, you mostly hear this at gym or crossfit box, but it is true. By spending some time and money on complying with GPDR, you are getting at least the following benefits:

- Understanding exactly where do you have data, in what form, and how it may be accessed
- Understanding and defining how this data has been/can be used, and being transparent about it
- Understanding the quality of collected data, and possibly improving it in the process
- You will have means to identify your registrars, and capability to build more digital era self-services on top of that
- In case of a nasty data breach, you will be more in control, and you will be able to limit the damages better
- Your customers will have more understanding and trust
- Your customers will be able to easily grant and revoke permissions for even more expanded use of their data in analysis
- Data export also creates new data processing opportunities
- Data erasure can be used to archive/erase personal data that is not actually needed anymore
- Self service, transparency, and data export processes will make it less likely that systems have stale, invalid customer data. 
- Since any analysis based on stale/invalid data would produce not just bad, but potentially damaging results - by being able to trust your data better, any analysis made on it is going to be better and more precise.

Currently we are living in a world where scary amount of data can be collected from individuals, and scary amount of insight can be deducted from this data. You could also replace the word 'scary' with 'amazing', if you are benefiting from said data. But from viewpoint of individual, current situation is pretty much the Wild West. Any data has been/can be collected, and often only visibility or control over it is a single checkbox saying: 'I accept any use of any of my data'. This does not encourage much trust. 













## Links

http://eur-lex.europa.eu/legal-content/EN/TXT/?uri=CELEX:32016R0679

http://www.tietosuoja.fi/fi/




